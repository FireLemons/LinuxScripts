#!/bin/bash
# Quick setup for a fresh linux install

# run "who" if you don't remember who the main user is
USER=flysy
# Set to true to skip expensive operations during testing
TEST=true

# Check if running as sudo
if [ "$EUID" -ne 0 ]; then
  echo $'ERROR: Not run with sudo\n  Exiting'
  exit 1
fi

# Add /usr/local/bin to PATH
if [[ $PATH != *"/usr/local/bin"* ]]; then
  echo $'\nINFO: Adding /usr/local/bin to \$PATH\n'
  sudo -u $USER PATH=$PATH:/usr/local/bin
else
  echo $'\nINFO: /usr/local/bin has already been added to \$PATH\n'
fi

# update existing packages
echo $'\nINFO: Updating Installed Packages\n'
if [[ $TEST != true ]]; then
  apt update
  apt upgrade
else
  echo $'  Test run. No packages will be updated and installed\n'
fi

# Remove bloat packages
if [[ $(dpkg -s thunderbird | grep Status) == *"installed" ]]; then
  #   Remove email manager
  apt purge thunderbird
fi

# Install wanted packages
function installCheck {
  if [[ $(dpkg -s $1 | grep Status) != *"installed" ]]; then
    apt install $1
  else
    echo "INFO: $1 is already installed"
  fi
}  
#   Install external drive format support
installCheck exfat-fuse

if [[ $(dpkg -s exfat-fuse | grep Status) != *"installed" ]]; then
  apt install exfat-utils
fi

#   Install file archivers
if [[ $(dpkg -s p7zip-full | grep Status) != *"installed" ]]; then
  apt install p7zip-full
fi

# Install cURL
if [[ $(dpkg -s curl | grep Status) != *"installed" ]]; then
  apt install curl
fi

# Install Macchanger
if [[ $(dpkg -s curl | grep Status) != *"installed" ]]; then
  apt install macchanger
fi

# Clean up
apt autoremove
